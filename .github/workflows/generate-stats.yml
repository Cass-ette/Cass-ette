name: Generate GitHub Stats Cards
on:
  schedule:
    - cron: "0 0 * * *"  # 每天自动更新
    workflow_dispatch:     # 允许手动触发

jobs:
  update-stats:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # 创建 stats 文件夹（确保目录存在）
      - name: Create stats directory
        run: mkdir -p ./stats

      # 生成 GitHub 总统计卡片
      - name: Generate GitHub Stats Card
        run: |
          curl -o ./stats/github-stats.svg \
          "https://github-readme-stats.vercel.app/api?username=Cass-ette&show_icons=true&theme=tokyonight&hide_border=true&bg_color=0D1117&title_color=58A6FF&icon_color=58A6FF&text_color=FFFFFF&include_all_commits=true&count_private=true"

      # 生成连续贡献卡片
      - name: Generate GitHub Streak Card
        run: |
          curl -o ./stats/github-streak.svg \
          "https://github-readme-streak-stats.herokuapp.com/?user=Cass-ette&theme=tokyonight&hide_border=true&background=0D1117&stroke=58A6FF&ring=58A6FF&fire=FF6B6B&currStreakLabel=58A6FF"

      # 生成最常用语言卡片
      - name: Generate Top Languages Card
        run: |
          curl -o ./stats/top-langs.svg \
          "https://github-readme-stats.vercel.app/api/top-langs/?username=Cass-ette&layout=compact&theme=tokyonight&hide_border=true&bg_color=0D1117&title_color=58A6FF&text_color=FFFFFF"

      # 提交生成的 SVG 文件到仓库
      - name: Commit and push stats
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Update GitHub stats cards"
          file_pattern: "stats/*.svg"
          commit_user_name: "GitHub Actions"
          commit_user_email: "actions@github.com"
